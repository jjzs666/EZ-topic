(self.webpackChunklms=self.webpackChunklms||[]).push([[54476],{354476:(e,t,i)=>{var r=i(708468),u=i(993776);function n(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t){var i;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(i=function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return Array.from(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return o(e,t)}(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var r=0,u=function(){};return{s:u,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:u}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,s=!0,l=!1;return{s:function(){i=e[Symbol.iterator]()},n:function(){var e=i.next();return s=e.done,e},e:function(e){l=!0,n=e},f:function(){try{s||null==i.return||i.return()}finally{if(l)throw n}}}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,r=new Array(t);i<t;i++)r[i]=e[i];return r}i(892222),i(126541),i(57327),i(969826),i(489554),i(226699),i(821249),i(185827),i(702707),i(140561),i(968309),i(891058),i(454747);var l=function(e,t){if(e.module_id=null,e.syllabus_id=null,function(e,t){(function(){var i,u=[],n=s(t.modules);try{for(n.s();!(i=n.n()).done;){var o,l=i.value,a=s(l.directActivities);try{for(a.s();!(o=a.n()).done;){var c=o.value;c.prerequisites&&c.prerequisites.length>0&&r.remove(c.prerequisites,(function(t){return t.activity_id===e.id&&t.activity_type===e.type}))}}catch(e){a.e(e)}finally{a.f()}u.push(l.syllabuses.map((function(t){return function(){var i,u=[],n=s(t.activities);try{for(n.s();!(i=n.n()).done;){var o=i.value;o.prerequisites&&o.prerequisites.length>0?u.push(r.remove(o.prerequisites,(function(t){return t.activity_id===e.id&&t.activity_type===e.type}))):u.push(void 0)}}catch(e){n.e(e)}finally{n.f()}return u}()})))}}catch(e){n.e(e)}finally{n.f()}})()}(e,t),"exam"===e.type)return e.referrer_id=t.id,e.referrer_type="course"};e.exports=function(){var e,t,i,o=(e=void 0,t=void 0,i=void 0,(o=function(){"use strict";function o(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),this.course=e,this.id=this.course.id,this.name=this.course.name,function(e,t){t&&t.hasOwnProperty("settings")?(e.allow_create_module=t.settings.allow_create_module,e.allow_create_syllabus=t.settings.allow_create_syllabus,e.allow_resort_module=t.settings.allow_resort_module,e.allow_resort_syllabus=t.settings.allow_resort_syllabus):(e.allow_create_module=!0,e.allow_create_syllabus=!0,e.allow_resort_module=!0,e.allow_resort_syllabus=!0)}(this.course,this.course.templateSetting);var t=this.course.allow_resort_module,i=this.course.allow_resort_syllabus,u=this.course.templateSetting&&"skeleton"in this.course.templateSetting?this.course.templateSetting.skeleton:{};r.map(this.course.modules,(function(e){e.directActivities=[],e.allow_resort=t;var n=e.id in u?u[e.id]:{};e.from_template=e.id in u,e.allow_delete=!("allow_delete"in n)||n.allow_delete,e.allow_update=!("allow_update"in n)||n.allow_update;var s="syllabus"in n?n.syllabus:{};return r.map(e.syllabuses,(function(e){e.activities=[],e.allow_resort=i;var t=e.id in s?s[e.id]:{};e.from_template=e.id in s,e.allow_delete=!("allow_delete"in t)||t.allow_delete,e.allow_update=!("allow_update"in t)||t.allow_update})),e.activities=e.activities||[],r.map(e.activities,(function(t){if(t.syllabus_id){var i=r.find(e.syllabuses,{id:t.syllabus_id});return i?i.activities.push(t):void 0}e.directActivities.push(t)}))}))}var a,c,d;return a=o,d=[{key:"initClass",value:function(){e=function(e){return r.forEach(e,(function(e){return t(e)}))},t=function(e){if(e.activities)return e.activities=r.sortBy(e.activities,["sort","id"])},i=function(e,t){var i=[];return r.every(t.modules,(function(u){return i=r.remove(u.syllabuses,{id:e}),r.forEach(i,(function(e){return r.forEach(e.activities,(function(e){return r.remove(u.activities,e),r.remove(t.activities,e)}))})),r.isEmpty(i)})),i}}}],(c=[{key:"getActivities",value:function(){var e=[];return r.each(this.course.modules,(function(t){return t.directActivities&&(e=e.concat(t.directActivities)),r.each(t.syllabuses,(function(t){if(t.activities)return e=e.concat(t.activities)}))})),e}},{key:"getActivitiesByType",value:function(e){var t=this.getActivities(),i={};return r.each(t,(function(t){return t.type===e&&(i[t.id]=t),!0})),i}},{key:"getSelectedActivitiesByType",value:function(e){var t=this.getActivitiesByType(e);return r.each(t,(function(e,i){return e.chosen||delete t[i],!0})),t}},{key:"getHomeworkActivities",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all";return r.reduce(this.course.modules,(function(t,i){return r.map(i.activities,(function(i){if(("all"===e||i.chosen)&&"homework"===i.type)return t[i.id]=i})),t}),{})}},{key:"getClassroomActivities",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all";return r.reduce(this.course.modules,(function(t,i){return r.map(i.activities,(function(i){if(("all"===e||i.chosen)&&"classroom"===i.type)return t[i.id]=i}))}),result,{})}},{key:"loadingModule",value:function(e,t){var i=this.getModule(e);i&&(i.loading=t)}},{key:"getSyllabus",value:function(e){var t,i=s(this.course.modules);try{for(i.s();!(t=i.n()).done;){var r,u=s(t.value.syllabuses);try{for(u.s();!(r=u.n()).done;){var n=r.value;if(n.id===e)return n}}catch(e){u.e(e)}finally{u.f()}}}catch(e){i.e(e)}finally{i.f()}}},{key:"collectChosenActivities",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"chosen",t=function(t){var i=r.select(t,e);return r.map(i,(function(e){return{activity_id:e.id,activity_type:e.type}}))};return r.reduce(this.course.modules,(function(e,i){return e.concat(t(i.activities))}),[])}},{key:"collectChosenModules",value:function(){var e=r.filter(this.course.modules,{chosen:!0});return r.map(e,(function(e){var t={module_id:e.id,syllabuses:[]};return r.forEach(e.syllabuses,(function(e){return e.chosen&&t.syllabuses.push({syllabus_id:e.id}),!0})),t}))}},{key:"collectPreviewedActivities",value:function(){return r.reduce(this.course.modules,(function(e,t){return e.concat((i=t.activities,u=r.filter(i,(function(e){return null!=e.data&&!0===e.data.is_previewed})),r.map(u,(function(e){return{activity_id:e.id,activity_type:e.type}}))));var i,u}),[])}},{key:"getSyllabuses",value:function(){return r.reduce(this.course.modules,(function(e,t){return e.concat(t.syllabuses)}),[])}},{key:"getModule",value:function(e){return r.find(this.course.modules,{id:e})}},{key:"sumScorePercentages",value:function(e){return r.reduce(e,(function(e,t){return e.plus(t.score_percentage?new u(t.score_percentage):0)}),new u(0))}},{key:"addSyllabus",value:function(e){e.allow_resort=!0,e.allow_update=!0,e.allow_delete=!0,e.from_template=!1;var t=this.getModule(e.module_id),i=r.sortedIndex(t.syllabuses,e,(function(e){return"".concat(e.date,"-").concat(e.id)}));return t.syllabuses.splice(i,0,e)}},{key:"updateSyllabus",value:function(e,t){return i(e.id,this.course),this.insertNewSyllabus(e,t),this.sortSyllabus()}},{key:"insertNewSyllabus",value:function(e,t){var i=this,r=this.getModule(parseInt(e.module_id));if(e.activities=t,r&&r.syllabuses.push(e),e.activities)return function(){var t,u=[],n=s(e.activities);try{for(n.s();!(t=n.n()).done;){var o=t.value;r&&(r.activities||(r.activities=[]),r.activities.push(o)),u.push(i.course.activities.push(o))}}catch(e){n.e(e)}finally{n.f()}return u}()}},{key:"sortSyllabus",value:function(){return r.forEach(this.course.modules,(function(t){return t.syllabuses=r.sortBy(t.syllabuses,["date","id"]),e(t.syllabuses)}))}},{key:"deleteModule",value:function(e){var t=this,i=r.remove(this.course.modules,{id:e.id});return r.each(i,(function(e){return r.each(e.activities,(function(e){return l(e,t.course)}))}))}},{key:"deleteSyllabus",value:function(e){var t=this,u=i(e.id,this.course);return r.each(u,(function(e){return r.each(e.activities,(function(e){return l(e,t.course)}))}))}},{key:"regroupSyllabus",value:function(e){var t=r.reduce(this.course.modules,(function(e,t){return t.syllabuses.length=0,e[t.id]=t,e}),{});return r.forEach(e,(function(e){return t[e.module_id].syllabuses.push(e)})),this.sortModules(),this.sortSyllabus()}},{key:"sortModules",value:function(){var e=this;this.course.modules=r.sortBy(this.course.modules,["sort","id"]);var t=0;return this.course.modules=r.forEach(this.course.modules,(function(i){return i.first=0===t,i.last=t===e.course.modules.length-1,i.sort=t++}))}},{key:"addModule",value:function(e){return e.allow_resort=!0,e.allow_update=!0,e.allow_delete=!0,e.from_template=!1,this.course.modules.push(e),this.sortModules()}},{key:"hasSyllabus",value:function(){return r.any(this.course.modules,(function(e){return e.syllabuses.length>0}))}},{key:"hasModule",value:function(){return!r.isEmpty(this.course.modules)}},{key:"hasPermission",value:function(e){return!this.course.templateSetting.hasOwnProperty("settings")||this.course.templateSetting.settings[e]}},{key:"hasOnlyOneEmptyModule",value:function(){return 1===this.course.modules.length&&function(e){return r.isEmpty(e.syllabuses)&&r.isEmpty(e.activities)}(this.course.modules[0])}},{key:"defaultModuleId",value:function(){return this.course.modules.length>0?this.course.modules[0].id:null}},{key:"filterByActivityType",value:function(e){return r.each(this.course.modules,(function(t){t.show=r.any(t.directActivities,{type:e}),r.map(t.syllabuses,(function(t){return t.show=r.any(t.activities,{type:e})})),t.show||(t.show=r.any(t.syllabuses,(function(e){return e.show})))}))}},{key:"filterByGroupHomework",value:function(){return r.each(this.course.modules,(function(e){e.show=r.any(e.directActivities,(function(e){return"homework"===e.type&&e.submit_by_group})),r.map(e.syllabuses,(function(e){return e.show=r.any(e.activities,(function(e){return"homework"===e.type&&e.submit_by_group}))})),e.show||(e.show=r.any(e.syllabuses,(function(e){return e.show})))}))}},{key:"hasSyllabusWithActivityType",value:function(){return r.any(this.course.modules,(function(e){return e.show}))}},{key:"isOutlineEmpty",value:function(){var e="";return r.forEach(this.course.course_outline,(function(t,i){if(!["id","end_date","status"].includes(i)&&t)return e+=t})),""===e}}])&&n(a.prototype,c),d&&n(a,d),o}()).initClass(),o);return o}}}]);