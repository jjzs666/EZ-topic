(self.webpackChunklms=self.webpackChunklms||[]).push([[18737],{576201:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});n(747042),n(583710);var r=n(480008),i="Asia/ShangHai";const o=function(){function e(){}return e.toLocalDateTime=function(e){return this.formatDatetime(e)},e.isAfterByNow=function(e){return"string"==typeof e?new Date(e)>=new Date:e>=new Date},e.isAfter=function(e,t){var n="string"==typeof e?new Date(e):e;return("string"==typeof t?new Date(t):t)>n},e.diffByHours=function(e,t){return void 0===t&&(t=null),t?r(t).diff(r(e),"hours"):r.utc().diff(r(e),"hours")},e.formatDatetime=function(e,t){return void 0===t&&(t="YYYY.MM.DD HH:mm:ss"),r(e).tz(i).format(t)},e.diffByMinutes=function(e,t){return void 0===t&&(t=null),t?r(t).diff(r(e),"minutes"):r.utc().diff(r(e),"minutes")},e.diffBySeconds=function(e,t){return void 0===t&&(t=null),t?r(t).diff(r(e),"seconds"):r.utc().diff(r(e),"seconds")},e.toYmd=function(e){return"string"==typeof e?r(e).format("YYYY.MM.DD"):r(e).tz(i).format("YYYY.MM.DD")},e.toHm=function(e){return"string"==typeof e?r(e).format("HH:mm"):r(e).tz(i).format("HH:mm")},e.toHms=function(e){return"string"==typeof e?r(e).format("HH:mm:ss"):r(e).tz(i).format("HH:mm:ss")},e.pad=function(e){return e>10?e:("0"+e).slice(-2)},e.secondsToHms=function(e){var t=Math.floor(e/60),n=e%60,r=Math.floor(t/60);return t%=60,this.pad(r)+":"+this.pad(t)+":"+this.pad(n)},e.startOfToday=function(){return r().tz(i).startOf("day")},e.endOfToday=function(){return r.tz(i).endOf("day")},e.endOfDay=function(e){return r.tz(e,i).endOf("day").toDate()},e.startOfWeek=function(){return r().tz(i).startOf("week")},e.endOfWeek=function(){return r().tz(i).endOf("week")},e.toLocalDate=function(e){return r(e).toDate()},e.todayRange=function(){return[this.startOfToday().toDate(),this.endOfToday().toDate()]},e.latestNDayRange=function(e){var t=this.endOfToday();return[this.endOfToday().subtract("days",e).add("seconds",1).toDate(),t.toDate()]},e.timeDifferenceMsg=function(e,t){var n=r(e),i=r(t);if(i.diff(n,"seconds")<0)return"-1";var o=i.diff(n,"days"),s=i.diff(n,"hours")-24*o,u=i.diff(n,"minutes")-60*i.diff(n,"hours"),c="";return c+=o<=0?"":o+"days",c+=s<=0?"":s+"hours",o>0?c:c+=(u<=0?1:u)+"minutes"},e}()},681423:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var r=n(370538);const i=function(){function e(){}return e.success=function(e,t){void 0===t&&(t=3),r.default.prototype.$Message.success({content:e,duration:t})},e.warning=function(e,t){void 0===t&&(t=3),r.default.prototype.$Message.warning({content:e,duration:t})},e.error=function(e,t){void 0===t&&(t=3),r.default.prototype.$Message.error({content:e,duration:t})},e}()},218544:(e,t,n)=>{var r=n(370538).default;n(66992),n(369070),n(241539),n(333948),Object.defineProperty(r.prototype,"$tt",{get:function(){return function(e){return r.t[e]}}}),e.exports={name:"translation",props:["keys"],data:function(){return{}},computed:{},created:function(){var e=this;return r.t||(r.t={}),function(){var t=[];for(var n in e.keys){var i=e.keys[n];t.push(r.t[n]=i)}return t}()},install:function(e){return e.component("translation",this)},render:function(e){}}},355413:e=>{e.exports={name:"vue-alert",props:["type","message","tile"],data:function(){return{}},computed:{},mounted:function(){},methods:{}}},477037:e=>{e.exports={name:"vue-popover-settings",props:{buttonLabel:{type:String},basicLabel:{type:String},caseLabel:{type:String},unorderedLabel:{type:String},calculateLabel:{type:String},placement:{type:String,default:"right-start"},caseSensitive:{type:Boolean,default:!1},unordered:{type:Boolean,default:!1}},data:function(){return{visible:!1,currentCaseSensitive:this.caseSensitive,currentUnordered:this.unordered}},computed:{},mounted:function(){},methods:{close:function(){return this.visible=!1},Change:function(e){var t={case_sensitive:this.currentCaseSensitive,unordered:this.currentUnordered};this.$emit("settings.changed",{label:e,value:t[e]})}}}},450509:e=>{e.exports={name:"vue-poptip",props:["trigger","popTitle","content","placement"],data:function(){return{}},computed:{},mounted:function(){},methods:{}}},509429:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var r=n(218544);const i=n.n(r)();const o=(0,n(551900).Z)(i,undefined,undefined,!1,null,null,null).exports},709564:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var r=n(355413);const i=n.n(r)();const o=(0,n(551900).Z)(i,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Alert",{class:{tile:e.tile},attrs:{type:e.type,"show-icon":""}},[n("span",{domProps:{innerHTML:e._s(e.message)}}),e._v(" "),(e.type,n("i",{staticClass:"font font-alert-warning",class:e.type,attrs:{slot:"icon"},slot:"icon"}))])}),[],!1,null,"3bdb0c2d",null).exports},188465:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var r=n(477037);const i=n.n(r)();const o=(0,n(551900).Z)(i,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Poptip",{ref:"popTip",attrs:{id:"popover-settings",placement:e.placement,width:"400",padding:"14px 12px"},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[n("a",{staticClass:"button button-green small"},[e._v(e._s(e.buttonLabel))]),e._v(" "),n("template",{slot:"content"},[n("Tabs",{attrs:{type:"card",animated:!1}},[n("TabPane",{attrs:{label:e.basicLabel}},[n("ul",[n("li",[n("Checkbox",{on:{"on-change":function(t){return e.Change("case_sensitive")}},model:{value:e.currentCaseSensitive,callback:function(t){e.currentCaseSensitive=t},expression:"currentCaseSensitive"}},[e._v(e._s(e.caseLabel))])],1),e._v(" "),n("li",[n("Checkbox",{on:{"on-change":function(t){return e.Change("unordered")}},model:{value:e.currentUnordered,callback:function(t){e.currentUnordered=t},expression:"currentUnordered"}},[e._v(e._s(e.unorderedLabel))])],1)])]),e._v(" "),e.calculateLabel?n("TabPane",{attrs:{label:e.calculateLabel}},[n("ul",[n("li",[n("Checkbox",{on:{"on-change":e.Change}},[e._v("輸入答案範圍")])],1),e._v(" "),n("li",[n("Checkbox",{on:{"on-change":e.Change}},[e._v("限制小數點位數")])],1),e._v(" "),n("li",[n("Checkbox",{on:{"on-change":e.Change}},[e._v("允許誤差值")])],1)])]):e._e(),e._v(" "),n("Icon",{attrs:{slot:"extra",type:"md-close"},on:{click:e.close},slot:"extra"})],1)],1)],2)}),[],!1,null,"2950349a",null).exports},593560:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var r=n(450509);const i=n.n(r)();const o=(0,n(551900).Z)(i,(function(){var e=this,t=e.$createElement;return(e._self._c||t)("Poptip",{attrs:{trigger:e.trigger,title:e.popTitle,content:e.content,placement:e.placement}},[e._t("default")],2)}),[],!1,null,null,null).exports},711816:(e,t,n)=>{"use strict";n.d(t,{Z:()=>u});n(892222),n(241539),n(788674),n(573210),n(932564);var r=n(708468),i=n(904072),o=n(216208);n(841812);const s={components:{activity_expiring:function(){return n.e(77133).then(n.bind(n,192764))},activity_expiring_today:function(){return n.e(48497).then(n.bind(n,92488))},activity_expiring_week:function(){return n.e(32402).then(n.bind(n,340749))},activity_opened:function(){return n.e(54599).then(n.bind(n,206193))},activity_opening:function(){return n.e(29874).then(n.bind(n,367388))},bulletin_created:function(){return n.e(66138).then(n.bind(n,117497))},bulletin_updated:function(){return n.e(4333).then(n.bind(n,556586))},calendar_event_alert:function(){return n.e(71018).then(n.bind(n,206462))},calendar_event_publish:function(){return n.e(2481).then(n.bind(n,805461))},calendar_timetable_delete:function(){return n.e(33270).then(n.bind(n,49520))},calendar_timetable_update:function(){return n.e(70403).then(n.bind(n,938294))},campus_subject_lib_audit_agree:function(){return n.e(79212).then(n.bind(n,587335))},campus_subject_lib_audit_reject:function(){return n.e(75563).then(n.bind(n,695459))},campus_subject_lib_off_the_shelf:function(){return n.e(27905).then(n.bind(n,67272))},course_completeness_alert:function(){return n.e(64242).then(n.bind(n,862040))},course_obe_unassociated_alert:function(){return n.e(56223).then(n.bind(n,264787))},course_score_alert:function(){return n.e(64242).then(n.bind(n,593472))},course_deleted:function(){return n.e(72128).then(n.bind(n,651931))},course_estimate:function(){return n.e(77418).then(n.bind(n,914687))},course_estimate_reply:function(){return n.e(97775).then(n.bind(n,955808))},course_homework_make_up:function(){return n.e(9440).then(n.bind(n,850681))},course_homework_remind:function(){return n.e(7693).then(n.bind(n,987959))},course_homework_resubmit:function(){return n.e(90416).then(n.bind(n,985960))},course_homework_review_remind:function(){return n.e(83833).then(n.bind(n,659998))},course_opening:function(){return n.e(98449).then(n.bind(n,734273))},course_outline_closing_edit:function(){return n.e(33002).then(n.bind(n,3745))},course_outline_edit:function(){return n.e(51736).then(n.bind(n,52130))},course_public_audit_response:function(){return n.e(32513).then(n.bind(n,712440))},course_started:function(){return n.e(6264).then(n.bind(n,742158))},discussion_create:function(){return n.e(85686).then(n.bind(n,396350))},discussion_score_updated:function(){return n.e(91422).then(n.bind(n,782604))},exam_ended:function(){return n.e(52061).then(n.bind(n,717052))},exam_expiring:function(){return n.e(94221).then(n.bind(n,631754))},exam_expiring_today:function(){return n.e(41232).then(n.bind(n,197194))},exam_expiring_week:function(){return n.e(65944).then(n.bind(n,881543))},exam_make_up:function(){return n.e(67423).then(n.bind(n,69243))},exam_opened:function(){return n.e(21357).then(n.bind(n,190623))},exam_score_updated:function(){return n.e(5336).then(n.bind(n,528214))},exam_submission:function(){return n.e(93116).then(n.bind(n,747161))},exam_submission_info:function(){return n.e(99263).then(n.bind(n,90827))},exam_submit_started:function(){return n.e(20283).then(n.bind(n,9577))},exam_will_start:function(){return n.e(20760).then(n.bind(n,85507))},group_recommend_homework_removed:function(){return n.e(94762).then(n.bind(n,963857))},has_recommend_homework:function(){return n.e(26376).then(n.bind(n,671687))},has_recommend_homework_group:function(){return n.e(58571).then(n.bind(n,462764))},homework_ended:function(){return n.e(22865).then(n.bind(n,653545))},homework_expiring:function(){return n.e(91649).then(n.bind(n,495403))},homework_expiring_today:function(){return n.e(56533).then(n.bind(n,333047))},homework_expiring_week:function(){return n.e(2147).then(n.bind(n,641503))},homework_is_recommended:function(){return n.e(52565).then(n.bind(n,399767))},homework_is_recommended_group:function(){return n.e(21767).then(n.bind(n,960121))},homework_opened_for_submission:function(){return n.e(11107).then(n.bind(n,921685))},homework_opening_for_submission:function(){return n.e(24648).then(n.bind(n,502293))},homework_review_started:function(){return n.e(21962).then(n.bind(n,799484))},homework_score_updated:function(){return n.e(72046).then(n.bind(n,852663))},homework_submitted:function(){return n.e(35533).then(n.bind(n,918511))},instructor_submit_course_public_audit:function(){return n.e(32491).then(n.bind(n,897144))},inter_score_ended:function(){return n.e(28538).then(n.bind(n,859316))},inter_score_expiring:function(){return n.e(11202).then(n.bind(n,267841))},inter_score_homework_submission:function(){return n.e(11202).then(n.bind(n,677663))},learning_activity_alert:function(){return n.e(104).then(n.bind(n,132508))},learning_progress_alert:function(){return n.e(25517).then(n.bind(n,157157))},learning_warning:function(){return n.e(60051).then(n.bind(n,549005))},new_resource_share_to_follower:function(){return n.e(99148).then(n.bind(n,219063))},org_plan_request:function(){return n.e(98873).then(n.bind(n,15596))},org_plan_response:function(){return n.e(65603).then(n.bind(n,692406))},plan_expired:function(){return n.e(47097).then(n.bind(n,893009))},post_create:function(){return n.e(54577).then(n.bind(n,936087))},questionnaire_remind:function(){return n.e(64424).then(n.bind(n,714382))},recent_plan_expire:function(){return n.e(49755).then(n.bind(n,69246))},recent_storage_run_out:function(){return n.e(39043).then(n.bind(n,35406))},recent_transfer_run_out:function(){return n.e(10369).then(n.bind(n,435260))},recommend_homework_removed:function(){return n.e(54125).then(n.bind(n,487092))},reply_created:function(){return n.e(52034).then(n.bind(n,27754))},resource_group_deleted:function(){return n.e(3289).then(n.bind(n,681626))},rollcall_alert:function(){return n.e(7159).then(n.bind(n,704221))},score_publish_closing:function(){return n.e(20936).then(n.bind(n,518436))},score_publish_reject:function(){return n.e(63515).then(n.bind(n,141980))},score_setting_changed:function(){return n.e(76120).then(n.bind(n,187069))},share_resource_to_user:function(){return n.e(41785).then(n.bind(n,838875))},shared_course_audit_agree:function(){return n.e(63700).then(n.bind(n,335318))},shared_course_audit_reject:function(){return n.e(69743).then(n.bind(n,765733))},shared_course_to_other_orgs_audit_agree:function(){return n.e(51565).then(n.bind(n,230309))},shared_resource_audit_agree:function(){return n.e(62684).then(n.bind(n,343611))},shared_resource_audit_reject:function(){return n.e(46191).then(n.bind(n,339875))},shared_resource_off_the_shelf:function(){return n.e(72406).then(n.bind(n,105614))},shared_resource_reported:function(){return n.e(44343).then(n.bind(n,171432))},shared_resource_to_other_orgs_audit_agree:function(){return n.e(12873).then(n.bind(n,544513))},shared_resource_to_other_orgs_audit_reject:function(){return n.e(78259).then(n.bind(n,506416))},shared_resource_to_other_orgs_off_the_shelf:function(){return n.e(78259).then(n.bind(n,587682))},shared_resource_to_other_orgs_reported:function(){return n.e(28855).then(n.bind(n,810506))},storage_run_out:function(){return n.e(60267).then(n.bind(n,938976))},submission_submitted:function(){return n.e(14104).then(n.bind(n,275950))},teaching_unit_invite:function(){return n.e(30953).then(n.bind(n,773280))},topic_create:function(){return n.e(33632).then(n.bind(n,1468))},topic_like:function(){return n.e(47953).then(n.bind(n,682180))},topic_replies:function(){return n.e(33597).then(n.bind(n,358481))},topic_secondary_replies:function(){return n.e(82114).then(n.bind(n,271046))},tracked_user_is_tracked:function(){return n.e(9568).then(n.bind(n,147325))},transfer_run_out:function(){return n.e(24238).then(n.bind(n,907113))},user_exit_course:function(){return n.e(97650).then(n.bind(n,91660))},user_join_course:function(){return n.e(68103).then(n.bind(n,290639))},user_join_resource_group:function(){return n.e(25060).then(n.bind(n,462726))},user_leave_resource_group:function(){return n.e(1286).then(n.bind(n,483345))},warning_opened:function(){return n.e(62530).then(n.bind(n,311152))},video_clipped:function(){return n.e(80199).then(n.bind(n,652280))},video_generated:function(){return n.e(80199).then(n.bind(n,652280))},master_course_synchronized:function(){return n.e(3667).then(n.bind(n,633642))},child_course_synchronized:function(){return n.e(3667).then(n.bind(n,633642))},create_research_meeting:function(){return n.e(3667).then(n.bind(n,601458))},research_meeting_will_begin:function(){return n.e(3667).then(n.bind(n,255040))},research_discussion_created:function(){return n.e(18493).then(n.bind(n,237251))},questionnaire_submitted:function(){return n.e(43098).then(n.bind(n,798612))},moodle_course_imported:function(){return n.e(18493).then(n.bind(n,624032))},resource_audit_rejected:function(){return n.e(59981).then(n.bind(n,749916))}},created:function(){var e=this,t="".concat(this.notificationServerUrl,"/users/").concat(this.userId,"/notifications?limit=5&additionalFields=unread_count&removed=only_mobile");return this.$http.get(t,{withCredentials:!0}).then((function(t){return e.unreadCount=t.body.unread_count,e.setUpPubSub()})).catch((function(){})),!1},computed:{displayedUnreadCount:function(){return this.unreadCount>99?"99+":this.unreadCount},displayedNotifications:function(){return r(this.notifications).sortBy("-timestamp").take(5).value()}},data:function(){return{serverData:JSON.parse(i("#notification-list-server-data").text().trim()),lang:i("html").attr("lang"),userId:i("#userId").data("id"),deliveryOrg:i("html").attr("delivery-org"),notificationServerUrl:i("#notificationServerUrl").data("url"),unreadCount:0,ui:{showNotifications:!1},notifications:[]}},methods:{showLatestNotificationList:function(){if(i(".notifications .entry").focus(),!this.ui.showNotifications)return this.getLatestNotification(),this.unreadCount>0&&this.markNotificationsAsRead(),this.ui.showNotifications=!0,!1},hideLatestNotificationList:function(){var e=this;return setTimeout((function(){return e.ui.touchList?(i(".notifications .entry").focus(),e.ui.touchList=!1):e.ui.showNotifications=i(".notifications .entry").is(":focus")}),150)},getLatestNotification:function(){return this.$http.get("".concat(this.notificationServerUrl,"/users/").concat(this.userId,"/notifications?limit=5"),{withCredentials:!0}).then((function(e){return this.notifications=e.body.notifications,this.unreadCount=0}))},markNotificationsAsRead:function(){return this.unreadCount=0,this.$http.post("".concat(this.notificationServerUrl,"/users/").concat(this.userId,"/notifications/read"),null,{withCredentials:!0})},viewAllNotifications:function(){},setUpPubSub:function(){var e=this,t={url:"".concat(this.notificationServerUrl,"/pubsub/").concat(this.userId),trackMessageLength:!0,transport:"websocket",fallbackTransport:"long-polling",onMessage:function(t){if(200===t.status)return e.ui.showNotifications?(e.getLatestNotification(),e.markNotificationsAsRead()):e.unreadCount+=1}};return o.subscribe(t)}}};const u=(0,n(551900).Z)(s,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"notification-list"}},[n("a",{staticClass:"entry",attrs:{href:"javascript:void(0)"},on:{click:function(t){return e.showLatestNotificationList()},blur:function(t){return e.hideLatestNotificationList()}}},[n("i",{staticClass:"icon font font-notification"}),e._v(" "),e.unreadCount>0?n("div",{staticClass:"count-wrapper"},[n("div",{},[n("span",{staticClass:"count radius"},[e._v(e._s(e.displayedUnreadCount))])])]):e._e()]),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.ui.showNotifications,expression:"ui.showNotifications"}],staticClass:"dropdown-list"},[n("ul",{on:{click:function(t){return e.showLatestNotificationList()}}},[0===e.notifications.length?n("li",{staticClass:"blank-notification-prompt"},[n("span",[e._v(e._s(e.$tt("no_notification")))])]):e._e(),e._v(" "),e._l(e.displayedNotifications,(function(t){return n("li",{staticClass:"notification"},[n(t.type,{tag:"component",attrs:{notification:t,lang:e.lang,org:e.deliveryOrg}})],1)})),e._v(" "),e.notifications.length>0?n("li",{staticClass:"more"},[n("a",{attrs:{href:"/user/index"},on:{click:function(t){return e.viewAllNotifications()}}},[e._v(e._s(e.$tt("view_all")))])]):e._e()],2)])])}),[],!1,null,"0673cf0b",null).exports},77732:(e,t,n)=>{"use strict";n.d(t,{Z:()=>y});n(892222),n(241539),n(788674),n(573210);var r=n(887757),i=n.n(r),o=(n(535666),n(507710)),s=n(356264),u=(n(382526),n(141817),n(932165),n(489554),n(66992),n(978783),n(454747),n(333948),n(409669)),c=n.n(u),a=n(496486),d=n.n(a),f=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function u(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,u)}c((r=r.apply(e,t||[])).next())}))},l=function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}};function h(e){return{content:e.message,isReply:e.isReply,type:e.type,recommends:e.data,sessionId:e.sessionId}}function _(e,t){return f(this,void 0,void 0,(function(){var n;return l(this,(function(r){return n={session_id:e,message:t},[2,c().post("/api/user/chat",n)]}))}))}function p(){return f(this,void 0,void 0,(function(){var e,t,n;return l(this,(function(r){switch(r.label){case 0:return[4,c().get("/api/user/chat")];case 1:return e=r.sent(),t=(0,s.camelizeKeys)(e.data),n=[],d().isEmpty(t)||t.forEach((function(e){n.push(h(e))})),[2,n]}}))}))}var b=n(48496);function m(e,t,n,r,i,o,s){try{var u=e[o](s),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,i)}function v(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function s(e){m(o,r,i,s,u,"next",e)}function u(e){m(o,r,i,s,u,"throw",e)}s(void 0)}))}}const g={name:"chat-robot",i18n:o.Z,props:{title:{type:String,default:""},welcome:{type:String,default:""}},data:function(){return{show:!1,text:"",loaded:!1,messages:[{content:this.welcome,isReply:!0,type:"text",recommends:[]}],sessionId:null}},created:function(){var e=this;window.addEventListener("chat-robot:open",(function(){e.show=!0}))},methods:{send:function(e){var t=this;return v(i().mark((function n(){var r,o,u,c,a;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(0!==e.trim().length){n.next=2;break}return n.abrupt("return");case 2:return r={content:e,isReply:!1,type:"text",recommends:[]},t.messages.push(r),t.text="",n.prev=5,n.next=8,_(t.sessionId,e);case 8:o=n.sent,u=(0,s.camelizeKeys)(o.data),c=h(u),t.messages.push(c),t.sessionId=c.sessionId,n.next=18;break;case 15:n.prev=15,n.t0=n.catch(5),b.Toast.error(null===(a=n.t0.response.data)||void 0===a?void 0:a.message);case 18:t.scrollToBottom();case 19:case"end":return n.stop()}}),n,null,[[5,15]])})))()},recoverChat:function(){var e=this;return v(i().mark((function t(){var n;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,p();case 2:n=t.sent,e.messages=e.messages.concat(n),n.length>0&&(e.sessionId=n[0].sessionId),e.scrollToBottom();case 6:case"end":return t.stop()}}),t)})))()},onVisibleChange:function(){var e=this;return v(i().mark((function t(){return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.loaded){t.next=4;break}return t.next=3,e.recoverChat();case 3:e.loaded=!0;case 4:e.show&&e.scrollToBottom();case 5:case"end":return t.stop()}}),t)})))()},scrollToBottom:function(){this.$nextTick((function(){var e=document.getElementById("chat-robot-content");e.scrollTop=e.scrollHeight}))},close:function(){this.show=!1}}};const y=(0,n(551900).Z)(g,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"chat-popup"},[n("Modal",{attrs:{"class-name":"chat-robot-popup",width:"440px","footer-hide":!0,"mask-closable":!1,scrollable:!1},on:{"on-visible-change":e.onVisibleChange},model:{value:e.show,callback:function(t){e.show=t},expression:"show"}},[n("template",{slot:"header"},[n("i",{staticClass:"font font-chat-robot"}),e._v(" "),n("span",[e._v(e._s(e.title))])]),e._v(" "),n("div",{staticClass:"content",attrs:{id:"chat-robot-content"}},e._l(e.messages,(function(t,r){return n("div",{key:r,staticClass:"message-card"},[n("div",{class:t.isReply?"robot-message":"user-message"},[n("div",{staticClass:"message-content"},[n("div",{style:t.isReply?"":"text-align:right;display: flex;flex-direction:row-reverse"},["text"===t.type?n("div",{staticClass:"message-body"},[e._v("\n                "+e._s(t.content)+"\n              ")]):n("div",{staticClass:"recommend-body"},[n("span",{staticClass:"recommend-tooltip"},[e._v(e._s(e.$t("ChatRobot.recommendTip")))]),e._v(" "),e._l(t.recommends,(function(t,r){return n("a",{key:"rec"+r,staticClass:"recommend-item",on:{click:function(n){return e.send(t)}}},[e._v("\n                  "+e._s(t)+"\n                ")])}))],2)])])])])})),0),e._v(" "),n("div",{staticClass:"input"},[n("Input",{attrs:{type:"textarea",border:!1},on:{"on-enter":function(t){return e.send(e.text)}},model:{value:e.text,callback:function(t){e.text=t},expression:"text"}}),e._v(" "),n("Button",{staticClass:"submit",on:{click:function(t){return e.send(e.text)}}},[e._v(e._s(e.$t("ChatRobot.send")))])],1)],2)],1)}),[],!1,null,"f64b898a",null).exports},576608:()=>{}}]);